main = ".open-next/worker.js"
name = "peabod-web"
account_id = "bb4c9b919e317b42c003591ab2cc4ecd"  # Paul@iwpi.com's Account
compatibility_date = "2025-03-25"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# D1 Database binding (read access for frontend)
[[d1_databases]]
binding = "DB"
database_name = "peabod-db"
database_id = "5ed11927-6e71-4496-b76f-a9fc3d4467f8"

# R2 Storage binding (for serving media)
[[r2_buckets]]
binding = "MEDIA"
bucket_name = "peabod"

[vars]
ENVIRONMENT = "production"
# Cloudflare account ID (same as account_id above)
CF_ACCOUNT_ID = "bb4c9b919e317b42c003591ab2cc4ecd"
# Stream customer subdomain (find in Cloudflare dashboard under Stream)
STREAM_CUSTOMER_SUBDOMAIN = "customer-XXXXX"

# Secrets (add via: wrangler secret put CF_API_TOKEN)
# CF_API_TOKEN - Cloudflare API token with Stream:Edit permission

# Custom domain routes
[[routes]]
pattern = "www.peabod.com/*"
zone_name = "peabod.com"

[[routes]]
pattern = "peabod.com/*"
zone_name = "peabod.com"
